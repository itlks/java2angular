<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:jsp="http://java.sun.com/JSP/Page"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	template="/templates/templateDialog.xhtml">

	<ui:define name="contentDialog">
		<p:outputPanel id="perfilAcessoAutorizacaoDialog">
			<p:outputPanel styleClass="row">
				<p:outputPanel styleClass="col-lg-12">
					<p:outputPanel
						styleClass="aviso-interno-blocos alert-information box-shadow">
						<i class="fa fa-exclamation-circle"></i>
						<span><p>#{msg['page.administrativo.perfilAutorizacao.preenchimento2.msg1']}</p>
							<p>#{msg['page.administrativo.perfilAutorizacao.preenchimento2.msg2']}</p></span>
					</p:outputPanel>
				</p:outputPanel>
			</p:outputPanel>
	
			<p:outputPanel styleClass="row">
				<p:outputPanel styleClass="col-lg-12">
					<p:outputPanel styleClass="titulo-painel">
						<h4>#{msg['page.administrativo.perfilAutorizacao.preenchimento2.titulo']}</h4>
					</p:outputPanel>
				</p:outputPanel>
			</p:outputPanel>
	
	
			<p:outputPanel id="panelPreenchimento" styleClass="row">
				<p:outputPanel styleClass="col-lg-12">
					<!-- titulo blocos -->
					<p:outputPanel styleClass="box-shadow">
	
						<p:outputPanel styleClass="row">
							<p:outputPanel styleClass="col-md-12">
	
								<p>
									<strong>#{msg['page.administrativo.perfilAutorizacao.preenchimento2.nomePerfil']}</strong>
									#{perfilAutorizacaoIncluirBBean.novoPerfil.nomePerfilAutorizacao}
								</p>
	
								<p>
									<strong>#{msg['page.administrativo.perfilAutorizacao.preenchimento2.descricao']}</strong>
									#{perfilAutorizacaoIncluirBBean.novoPerfil.descricaoPerfilAutorizacao}
								</p>
								<br />
	
								<p>
									#{msg['page.administrativo.perfilAutorizacao.preenchimento2.msg3']}
									<i class="fa fa-plus-square iconeTexto" aria-hidden="true"></i>
									#{msg['page.administrativo.perfilAutorizacao.preenchimento2.msg4']}
								</p>
								<br />
	
								<p:outputPanel styleClass="link-marker">
									<span><strong>&gt;</strong> <p:commandLink
											id="cmdLinkExpandir"
											value="#{perfilAutorizacaoIncluirBBean.textComandoLink}">
	
											<p:ajax event="click"
												listener="#{perfilAutorizacaoIncluirBBean.expandirTodos(event)}"
												update=":formGeral:panelPreenchimento" process="@this" />
										</p:commandLink></span>
								</p:outputPanel>
	
								<p:separator />
							</p:outputPanel>
						</p:outputPanel>
	
						<p:outputPanel styleClass="row">
							<p:outputPanel styleClass="col-md-5">
								<br />
								<p:outputPanel styleClass="checkbox">
									<p:selectBooleanCheckbox id="chkSelecionarTodos"
										binding="#{perfilAutorizacaoIncluirBBean.selectBooleanCheckbox}">
										<p:ajax
											listener="#{perfilAutorizacaoIncluirBBean.aplicarTransacoes(event)}"
											update=":formGeral:panelPreenchimento" process="@this" />
									</p:selectBooleanCheckbox>
									<h:outputLabel for="cb2_1" style="width: 350px;">
	                        			#{msg['page.administrativo.perfilAutorizacao.preenchimento2.aplicar']}
	                     			</h:outputLabel>
								</p:outputPanel>
							</p:outputPanel>
							<p:outputPanel styleClass="col-md-2">
								<p:outputPanel styleClass="form-group" style="margin-left: -10px;">
									<h:outputLabel for="">#{msg['page.administrativo.perfilAutorizacao.preenchimento2.nome']}</h:outputLabel>
	
									<p:inputText id="qtdAssinaturas" styleClass="form-control"
										onkeypress="return onlyNumbers(event)"
										onblur="onlyNumbersGare(this)" style="width: 80px;"
										binding="#{perfilAutorizacaoIncluirBBean.inputTextQndAss}" maxlength="2">
	
										<p:ajax event="blur"
											listener="#{perfilAutorizacaoIncluirBBean.aplicaValorAtodos(event)}"
											update="@(.transacoes-conteudo)" process="@this" />
									</p:inputText>
	
								</p:outputPanel>
	
							</p:outputPanel>
	
							<p:outputPanel styleClass="col-md-2" style="margin-left: -80px;width: 250px;">
								<p:outputPanel styleClass="form-group text-right">
									<h:outputLabel styleClass="text-right">#{msg['page.administrativo.perfilAutorizacao.preenchimento2.nome2']}</h:outputLabel>
									<p:inputText styleClass="form-control text-right"
										onkeypress="return onlyNumbers(event)"
										onblur="onlyNumbersGare(this); maskMoneyWithoutZero(this); "
										converter="valorDecimalConverter"
										id="txtValorAlcadaTodos"
										binding="#{perfilAutorizacaoIncluirBBean.inputValAlcada}" maxlength="15">
										<p:ajax event="blur"
											listener="#{perfilAutorizacaoIncluirBBean.aplicaValorAtodos(event)}"
											update="@(.transacoes-conteudo)" process="@this" />
									</p:inputText>
	
								</p:outputPanel>
							</p:outputPanel>
	
							<p:outputPanel styleClass="col-md-2" style="width: 250px;">
								<p:outputPanel styleClass="form-group text-right">
									<h:outputLabel for="">#{msg['page.administrativo.perfilAutorizacao.preenchimento2.nome3']}</h:outputLabel>
									<p:inputText styleClass="form-control text-right" converter="valorDecimalConverter"
										 	onkeypress="return onlyNumbers(event)"
										onblur=" onlyNumbersGare(this); maskMoneyWithoutZero(this);"
										id="txtLimiteDiarioTodos"
										binding="#{perfilAutorizacaoIncluirBBean.inputTextLimiteDiario}" maxlength="15">
										<p:ajax event="blur"
											listener="#{perfilAutorizacaoIncluirBBean.aplicaValorAtodos(event)}"
											update="@(.transacoes-conteudo)" process="@this" />
									</p:inputText>
								</p:outputPanel>
							</p:outputPanel>
						</p:outputPanel>
	
						<p:outputPanel styleClass="row">
							<p:outputPanel styleClass="col-md-12">
								<p:separator />
							</p:outputPanel>
						</p:outputPanel>
	
						<!-- /////////////////////////////////// UI:Repeat//////////////////////////////////////////////////// -->
	
						<p:outputPanel id="panelGrupoTransacoes"
							styleClass="transacoes-conteudo">
	
	
							<ui:repeat var="servico"
								value="#{perfilAutorizacaoIncluirBBean.listaServicos}">
								<br />
								<h:outputText value="#{servico.nomeServico}"></h:outputText>
								<br />
								<br />
	
								<p:panelGrid
									styleClass="grid-header header-left-grid table-perfil-autorizacao dotted-table"
									style="width: 97%;">
	
									<f:facet name="header">
										<p:row>
											<p:column colspan="3">
												<h:outputText
													value="#{msg['pages.administrativo.perfilAutorizacao.alterarPreenchimento.transacoes']}" />
											</p:column>
	
											<p:column>
												<h:outputText
													value="#{msg['pages.administrativo.perfilAutorizacao.alterarPreenchimento.quantass']}" />
											</p:column>
	
											<p:column styleClass="text-right">
												<h:outputText style="margin-left:15px;"
													value="#{msg['pages.administrativo.perfilAutorizacao.alterarPreenchimento.valalcada']}" />
											</p:column>
	
											<p:column  styleClass="text-right">
												<h:outputText style="margin-left:15px;"
													value="#{msg['pages.administrativo.perfilAutorizacao.alterarPreenchimento.limitdiario']}" />
											</p:column>
										</p:row>
									</f:facet>
									<p:row>
										<p:column style="text-align: center;">
											<h:commandLink>
	
												<h:graphicImage value="#{servico.imagem}" alt="expandir" />
												<f:ajax event="click"
													listener="#{perfilAutorizacaoIncluirBBean.rendeerPanel(servico)}"
													execute="@this" render=":formGeral:panelPreenchimento" />
	
											</h:commandLink>
										</p:column>
	
										<p:column>
											<p:selectBooleanCheckbox value="#{servico.checkPrincipal}"
												disabled="#{perfilAutorizacaoIncluirBBean.selectBooleanCheckbox.isSelected()}">
												<p:ajax event="change" update=":formGeral:panelPreenchimento"
													listener="#{perfilAutorizacaoIncluirBBean.aplicarTransacoesGrid(servico)}" />
											</p:selectBooleanCheckbox>
										</p:column>
										
										<p:column style="width:40%; word-break: break-word;">
											<h:outputText
												value="#{msg['pages.administrativo.perfilAutorizacao.alterarPreenchimento.text6']}"></h:outputText>
										</p:column>
	
										<p:column style="width: 10%;">
											<p:inputText styleClass="form-control"
												value="#{servico.quantidadeTransacao}"
												onkeypress="return onlyNumbers(event)"
												maxlength="2"
												onblur="onlyNumbersGare(this)"
												disabled="#{(perfilAutorizacaoIncluirBBean.selectBooleanCheckbox.isSelected() or !servico.checkPrincipal)}">
												<p:ajax event="blur" process="@this"
													update=":formGeral:panelPreenchimento"
													listener="#{perfilAutorizacaoIncluirBBean.aplicarTransacoesGridAplicavlor(servico)}" />
											</p:inputText>
										</p:column>
	
										<p:column style="width: 25%; padding-left: 15px" styleClass="text-right"> 
											<p:outputPanel>
												<h:outputText value="--" 
													rendered="#{!servico.renderizaInputValorAlcada}" />
											</p:outputPanel>
	
	
											<p:inputText styleClass="form-control text-right"
												rendered="#{servico.renderizaInputValorAlcada}"  converter="valorDecimalConverter"
												value="#{servico.valorAlcada}"
												onkeypress="return onlyNumbers(event)" 
												onblur="onlyNumbersGare(this); maskMoneyWithoutZero(this); "
												maxlength="15"
												disabled="#{(perfilAutorizacaoIncluirBBean.selectBooleanCheckbox.isSelected() or !servico.checkPrincipal)}">
												<p:ajax event="blur" process="@this"
													update=":formGeral:panelPreenchimento"
													listener="#{perfilAutorizacaoIncluirBBean.aplicarTransacoesValorAlcada(servico)}" />
											</p:inputText>
										</p:column>
	
										<p:column style="width: 25%; padding-left: 15px" styleClass="text-right">
											<p:outputPanel>
												<h:outputText value="--"
													rendered="#{!servico.renderizaInputValorDiario}" />
											</p:outputPanel>
	
											<p:inputText styleClass="form-control text-right"
												rendered="#{servico.renderizaInputValorDiario}"  converter="valorDecimalConverter"
												value="#{servico.valorDiario}" 
												onkeypress="return onlyNumbers(event)" 
												onblur="onlyNumbersGare(this); maskMoneyWithoutZero(this); "
												maxlength="15"
												disabled="#{(perfilAutorizacaoIncluirBBean.selectBooleanCheckbox.isSelected() or !servico.checkPrincipal)}">
												<p:ajax event="blur" process="@this"
													update=":formGeral:panelPreenchimento"
													listener="#{perfilAutorizacaoIncluirBBean.aplicarTransacoesLimiteDiario(servico)}" />
											</p:inputText>
										</p:column>
									</p:row>
								</p:panelGrid>
	
	
								<h:panelGroup id="panelgrupo" rendered="#{servico.renderPanel}">
	
									<ui:repeat var="tipoTransacoes" value="#{servico.transacoes}">
	
										<p:panelGrid id="panelTransacoes"
										style=" margin-top: 10px; width: 97%;"
											styleClass="table-perfil-autorizacao grid-header border-column-dotted no-border">
											<p:row>
										<p:column style="height: 15px; width: 25px; display: block;" styleClass="no-border">
											
										</p:column>
												<p:column >
													<p:selectBooleanCheckbox value="#{tipoTransacoes.checked}"
														disabled="#{servico.checkPrincipal}">
														<p:ajax event="change" process="panelTransacoes"
															update="panelTransacoes"
															listener="#{perfilAutorizacaoIncluirBBean.aplicarTransacoesGrids(tipoTransacoes)}" />
													</p:selectBooleanCheckbox>
												</p:column>
												
												<p:column style="width:40%; word-break: break-all;">
													<span><h:outputText value="#{tipoTransacoes.nomeTransacao}" /></span>
												</p:column>
	
												<p:column style="width: 10%;">
													<p:inputText 
													disabled="#{(servico.checkPrincipal and tipoTransacoes.checked) or (!servico.checkPrincipal and !tipoTransacoes.checked)}"
														placeholder=""
														onkeypress="return onlyNumbers(event)"
														onblur="onlyNumbersGare(this)"
														value='#{tipoTransacoes.qtdAssinaturas}'
														styleClass="form-control"
														maxlength="2" >
														<p:ajax process="@this" />
													</p:inputText>
												</p:column>
	
												<p:column style="width: 25%; padding-left: 15px" styleClass="text-right"> 
													<p:outputPanel>
														<h:outputText value="--"
															rendered="#{!servico.renderizaInputValorAlcada}" />
													</p:outputPanel>
	
													<p:inputText styleClass="form-control text-right"
														placeholder=""
														rendered="#{servico.renderizaInputValorAlcada}"
														value='#{tipoTransacoes.valorAlcada}'
														onkeypress="return onlyNumbers(event)" 
														onblur="onlyNumbersGare(this); maskMoneyWithoutZero(this); "
														converter="valorDecimalConverter"
														maxlength="15"
														disabled="#{(servico.checkPrincipal and tipoTransacoes.checked) or (!servico.checkPrincipal and !tipoTransacoes.checked)}"
														>
														<p:ajax event="blur" process="@this" partialSubmit="true" />	
													</p:inputText>
												</p:column>
	
												<p:column style="width: 25%; padding-left: 15px" styleClass="text-right"> 
													<p:outputPanel>
														<h:outputText value="--"
															rendered="#{!servico.renderizaInputValorDiario}" />
													</p:outputPanel>
	
													<p:inputText styleClass="form-control text-right"
														placeholder=""
														rendered="#{servico.renderizaInputValorDiario}"
														value='#{tipoTransacoes.valorDiario}'
														maxlength="15"
														onkeypress="return onlyNumbers(event)" 
														onblur="onlyNumbersGare(this); maskMoneyWithoutZero(this); "
														converter="valorDecimalConverter"
														disabled="#{(servico.checkPrincipal and tipoTransacoes.checked) or (!servico.checkPrincipal and !tipoTransacoes.checked)}">
														<p:ajax event="blur" process="@this" partialSubmit="true" />	
													</p:inputText>
	
												</p:column>
											</p:row>
										</p:panelGrid>
	
									</ui:repeat>
	
								</h:panelGroup>
							</ui:repeat>
	
						</p:outputPanel>
					</p:outputPanel>
				</p:outputPanel>
			</p:outputPanel>
		</p:outputPanel>
	
		<p:outputPanel styleClass="row space-b">
			<p:outputPanel styleClass="col-md-12 text-right">
				<p:commandLink styleClass="btn btn-default btn-cinza pull-left"
					href="#" role="button" id="btnCancelarDialog"
					value="#{msg['pages.administrativo.perfilAutorizacao.alterarPreenchimento.cancelar']}"
					action="#{perfilAutorizacaoIncluirBBean.cancelarDialog}" />

				<p:commandLink styleClass="btn btn-default btn-cinza"
					role="button" id="btnVoltarDialog"
					value="#{msg['pages.administrativo.perfilAutorizacao.alterarPreenchimento.voltar']}"
					action="#{perfilAutorizacaoIncluirBBean.voltarPreenchimento1Dialog}"
					style="margin-right:10px;" />

				<p:blockUI block="btnConfirmacaoDialog" trigger="btnConfirmacaoDialog" />	
				<p:commandLink styleClass="btn btn-default" role="button"
					action="#{perfilAutorizacaoIncluirBBean.continuarTelaPreenchimentoDialog}"
					ajax="true" update="formGeral:perfilAcessoAutorizacaoDialog" process="formGeral:perfilAcessoAutorizacaoDialog"
					id="btnConfirmacaoDialog" onstart="dialog_block();" oncomplete="dialog_unblock();"
					value="#{msg['pages.administrativo.perfilAutorizacao.alterarPreenchimento.continuar']}">
				</p:commandLink>
			</p:outputPanel>
		</p:outputPanel>
		
	</ui:define>
</ui:composition>
